(function(b,k){b.module("app.libs",[])})(window.angular);(function(b,k,n,f){b.module("app.libs").factory("Velocity",function(){return k||n.fn.velocity})})(window.angular,window.Velocity,window.jQuery);(function(b,k){b.module("app","app.core app.libs app.directives app.models app.services app.filters app.storage app.levantamentos app.auth app.layout".split(" "))})(window.angular);(function(b,k){b.module("app.core","ngAnimate ngAria ngMessages ngLocale ngResource ngSanitize encrypt blocks.logger blocks.exception ui.router ui.bootstrap LocalStorageModule".split(" "))})(window.angular);(function(b,k){function n(c,d){return{request:function(g){var a=d.get("User");0===g.url.indexOf(c)&&(g.params.token=a.getToken(),console.log(g));return g}}}function f(c,d,g,a){var l=0;return{request:function(a){var e=!1;0===a.url.indexOf(c)&&a.data&&b.isArray(a.data.Comentario)&&(e=!0,a.data={});a.url&&"https://fatoresweb.azurewebsites.net/api/v1/token"===a.url&&a.params&&"wake"===a.params.username&&(e=!0);0!==a.url.indexOf(c)||e||(l++,g.$broadcast("loader:show"));return a||d.when(a)},response:function(a){0===
a.config.url.indexOf(c)&&0>=--l&&(l=0,g.$broadcast("loader:hide"));return a||d.when(a)},responseError:function(a){a.message&&"Converting circular structure to JSON"===a.message&&0>=--l&&(l=0,g.$broadcast("loader:hide"));a.config&&0===a.config.url.indexOf(c)&&0>=--l&&(l=0,g.$broadcast("loader:hide"));return d.reject(a)}}}var e=b.module("app.core");e.config(["$httpProvider",function(c){c.interceptors.push(n,f)}]);n.$inject=["dbUrl","$injector"];f.$inject=["dbUrl","$q","$rootScope","$injector"];e.config(["$animateProvider",
function(c){c.classNameFilter(/animate-options/)}]);e.run(["$rootScope","$state","$stateParams","logger",function(c,d,g,a){c.$on("$stateChangeStart",function(d,c){a.info("routing to "+c.url,null,"config.js: stateChangeStart")});c.$on("$stateChangeSuccess",function(d,c){a.success("routing to "+c.url,null,"config.js: stateChangeSuccess")});c.$on("$stateChangeError",function(d,c,g,h,b,q){a.error("routing to "+c.url,null,"config.js: stateChangeError");a.error("error "+q,null,"config.js: stateChangeError")})}])})(window.angular);(function(b,k){b.module("app.core").value("dbUrl","https://fatoresweb.azurewebsites.net/api/v1/")})(window.angular);(function(b,k){b.module("app.core").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(b,f,e){function c(){return{templateUrl:"scripts/partials/toolbar.html",controller:"toolbarController",controllerAs:"toolbar"}}function d(){return{templateUrl:"scripts/partials/sidebar.html",controller:"sidebarController",controllerAs:"sidebar"}}function g(){return{templateUrl:"scripts/partials/tabs.html"}}f.otherwise("/");b.state("login",{url:"/",auth:!1,views:{content:{templateUrl:"scripts/auth/login.html",
controller:"Login as vm"}},resolve:{wakeup:["$q","dataservice",function(a,d){var c=a.defer();d.get({item:"token",username:"wake",password:""},1)["finally"](function(){c.resolve()});return c.promise}]}}).state("configuracao",{url:"/configuracao",auth:!0,data:{toolbar:{pageTitle:"Configura\u00e7\u00e3o"}},views:{content:{templateUrl:"scripts/layout/configuracao.html",controller:"Configuracao as vm",resolve:{dados:["ConfigurationService",function(a){return a.get()}],session:["$q","Sessions",function(a,
d){var c=a.defer();c.resolve(d.current());return c.promise}]}},toolbar:c(),sidebar:d()}}).state("equipe",{url:"/equipe",auth:!0,data:{toolbar:{pageTitle:"Equipe"},footer:{buttons:{ok:{title:"Confirmar",toState:"equipe"}}}},views:{content:{templateUrl:"scripts/layout/equipe.html",controller:"equipeController as equipe",resolve:{funcoes:["Entidades","ConfigurationService","sortBrFilter",function(a,d,c){d=d.select("Tarefa");return c(a.get("funcao",d.Funcoes),"Nome")}]}},toolbar:c(),sidebar:d()}}).state("recursos",
{url:"/recursos",auth:!0,data:{toolbar:{pageTitle:"Recursos"}},views:{content:{templateUrl:"scripts/layout/recursos.html",controller:"recursosController as recursos"},toolbar:c(),sidebar:d(),tabs:g()}}).state("comentarios",{url:"/comentarios",auth:!0,data:{toolbar:{pageTitle:"Comentarios"}},views:{content:{templateUrl:"scripts/layout/comentarios.html",controller:"comentariosController as comentarios"},toolbar:c()}}).state("atividades",{url:"/atividades",auth:!0,data:{toolbar:{pageTitle:"Atividades"}},
views:{content:{templateUrl:"scripts/layout/atividades.html",controller:"atividadesController as atividades"},toolbar:c()}}).state("cenarios",{url:"/cenarios",auth:!0,data:{toolbar:{pageTitle:"Cen\u00e1rios"}},views:{content:{templateUrl:"scripts/cenarios/cenarios.html",controller:"cenariosController as cenarios"},toolbar:c(),sidebar:d(),tabs:g()}}).state("producao",{url:"/producao",auth:!0,data:{toolbar:{pageTitle:"Produ\u00e7\u00e3o"}},views:{content:{templateUrl:"scripts/producao/producao.html",
controller:"producaoController as producao"},toolbar:c(),sidebar:d(),tabs:g()}}).state("produtoNovo",{url:"/produto/novo",auth:!0,data:{toolbar:{pageTitle:"Novo produto"}},views:{content:{templateUrl:"scripts/producao/produtoCreate.html",controller:"produtoController as produto",resolve:{Produto:[function(){return null}]}},toolbar:c(),sidebar:d(),tabs:g()}}).state("produto",{url:"/produto/:id",auth:!0,data:{toolbar:{pageTitle:""}},views:{content:{templateUrl:"scripts/producao/produto.html",controller:"produtoController as produto",
resolve:{Produto:["$state","$stateParams","producaoService",function(a,d,c){d=c.Produtos.get(d.id);a.$current.data.toolbar.pageTitle=d.Identificadores;return d}]}},toolbar:{templateUrl:"scripts/partials/toolbar.html",controller:"toolbarController",controllerAs:"toolbar"},sidebar:d(),tabs:g()}}).state("produtoEdit",{url:"/produto/edit/:id",auth:!0,data:{toolbar:{pageTitle:"Editar produto"}},views:{content:{templateUrl:"scripts/producao/produtoEdit.html",controller:"produtoController as produto",resolve:{Produto:["$stateParams",
"producaoService",function(a,d){return d.Produtos.get(a.id)}]}},toolbar:c(),sidebar:d(),tabs:g()}}).state("credits",{url:"/credits",templateUrl:"credits.html",data:{pageTitle:"Credits"}}).state("estudo",{url:"/estudo",templateUrl:"estudo.html"})}]).run(["$rootScope","$state","$stateParams","authservice",function(b,f,e,c){b.$on("$stateChangeStart",function(d,g,a){return g.auth&&!c.isLogged()?(d.preventDefault(),f.go("login")):!0})}])})(window.angular);(function(b,k){b.module("app.core").factory("common",["$q","$state","logger",function(b,f,e){return{routes:{to:function(c){e.info("Going to "+c,null,"common.js: Route");f.go(c)}},promise:b}}])})(window.angular);(function(b,k){function n(f,e,c,d,g){function a(a,g,h){var e=a,q=g,t=h;"number"===typeof g&&(t=g,q={});"object"===typeof a&&a.item&&(e=a.item,delete a.item,q=a);var f=l(e,q||{}),n=c(function(){d.error("request for "+e+" aborted",null,"dataservice.js: timeout");f.interrupt()},1E3*t||25E3);f["finally"](function(){c.cancel(n);n=b.noop;f=h=t=q=g=e=a=null});return f}function l(a,c){if("string"!==typeof a&&"object"!==typeof c)throw d.error("Argumentos no formato errado",null,"dataservice.js: xhr request"),
Error("argumento no formato errado");var l=f.defer(),n=e({method:"get",url:g+a,timeout:l.promise,params:c}),q=n.then(function(a){return a.data},function(a){return f.reject(a)});q.interrupt=function(){l.resolve()};q["finally"](function(){q.interrupt=b.noop;l=n=q=null});return q}return{requestToken:function(d,c){return a({item:"token",username:d,password:c},60)},get:a,post:function(a,d){return e({method:"post",url:g+a,data:d,params:{}})}}}b.module("app.core").factory("dataservice",n);n.$inject=["$q",
"$http","$timeout","logger","dbUrl"]})(window.angular);(function(b,k){b.module("blocks.exception",["blocks.logger"])})(window.angular);(function(b,k){b.module("blocks.exception").factory("exception",["logger",function(b){return{catcher:function(f){return function(e){b.error(f,e)}}}}])})(window.angular);(function(b,k){function n(b){b.decorator("$exceptionHandler",f)}function f(b,c,d){var g=c.config.appErrorPrefix||"";return function(a,c){b(a,c);d.error(g+a.message,{exception:a,cause:c})}}b.module("blocks.exception").provider("exceptionConfig",function(){this.config={};this.$get=function(){return{config:this.config}}}).config(n);n.$inject=["$provide"];f.$inject=["$delegate","exceptionConfig","logger"]})(window.angular);(function(b,k,n){b.module("blocks.logger",[]).value("toastr",k)})(window.angular,window.toastr);(function(b,k){function n(b,e){function c(c,a,l){e.warning(c,l);b.warn("Warning: "+c,d(a))}function d(d){return d||(new Date).toLocaleTimeString()||(new Date).toTimeString()}return{showToasts:!0,error:function(c,a,l){e.error(c,l);b.error("Error: "+c,d(a))},info:function(c,a,l){e.info(c,l);b.info("Info: "+c,d(a))},success:function(c,a,l){e.success(c,l);b.info("Success: "+c,d(a))},warning:c,warn:c,log:b.log}}b.module("blocks.logger").factory("logger",n);n.$inject=["$log","toastr"]})(window.angular);(function(b,k){b.module("encrypt",[])})(window.angular);(function(b,k){b.module("encrypt").factory("cryptojs",["$window",function(b){return b.CryptoJS}])})(window.angular);(function(b,k){b.module("encrypt").factory("encryptService",["cryptojs",function(b){var f=b.AES;return{hash:function(e){return b.SHA3(e).toString()},encrypt:function(b,c){return f.encrypt(b,c).toString()},decrypt:function(b,c){return f.decrypt(b,c)}}}])})(window.angular);(function(b,k){b.module("app.filters",[])})(window.angular);(function(b,k){b.module("app.filters").filter("hashById",function(){return function(b){var f={};b.forEach(function(b){f[b.Id]=b});return f}}).filter("unhashById",function(){return function(b){if(b){var f=[];Object.keys(b).forEach(function(e){f.push(b[e])});return f}}})})(window.angular);(function(b,k){b.module("app.filters").filter("getUnique",function(b){for(var f={},e=[],c=b.length,d=0;d<c;d++)f[b[d]]||(f[b[d]]=!0,e.push(b[d]));return e})})(window.angular);(function(b,k){b.module("app.filters").filter("removeDiacritics",function(){var b={"\u24b6":"A","\uff21":"A","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\u00c3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\u00c4":"A","\u01de":"A","\u1ea2":"A","\u00c5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A",
"\ua732":"AA","\u00c6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u00c7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D",
"\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\u00cb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F",
"\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\u00cf":"I",
"\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L",
"\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\u00d1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O",
"\u00d5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\u00d6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\u00d8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u0152":"OE","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P",
"\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S",
"\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u1e9e":"SS","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\u00d9":"U","\u00da":"U","\u00db":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\u00dc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U",
"\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\u00dd":"Y",
"\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\u00e3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a",
"\u1eb3":"a","\u0227":"a","\u01e1":"a","\u00e4":"a","\u01df":"a","\u1ea3":"a","\u00e5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\u00e6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c",
"\u0109":"c","\u010b":"c","\u010d":"c","\u00e7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e",
"\u00eb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h",
"\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\u00ef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k",
"\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\u00f1":"n","\u1e45":"n",
"\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\u00f5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\u00f6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o",
"\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\u00f8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u0153":"oe","\u0276":"oe","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r",
"\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u017f":"s","\u1e9b":"s","\u00df":"ss","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t",
"\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\u00fc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v",
"\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\u00fd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\u00ff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z",
"\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\uff10":"0","\u2080":"0","\u24ea":"0","\u2070":"0","\u00b9":"1","\u2474":"1","\u2081":"1","\u2776":"1","\u24f5":"1","\u2488":"1","\u2460":"1","\uff11":"1","\u00b2":"2","\u2777":"2","\u2475":"2","\uff12":"2","\u2082":"2","\u24f6":"2","\u2461":"2","\u2489":"2","\u00b3":"3","\uff13":"3","\u248a":"3","\u2476":"3","\u2083":"3","\u2778":"3","\u24f7":"3","\u2462":"3","\u24f8":"4",
"\u2463":"4","\u248b":"4","\uff14":"4","\u2074":"4","\u2084":"4","\u2779":"4","\u2477":"4","\u248c":"5","\u2085":"5","\u24f9":"5","\u2478":"5","\u277a":"5","\u2464":"5","\uff15":"5","\u2075":"5","\u2479":"6","\u2076":"6","\uff16":"6","\u277b":"6","\u2086":"6","\u2465":"6","\u24fa":"6","\u248d":"6","\uff17":"7","\u2077":"7","\u277c":"7","\u24fb":"7","\u248e":"7","\u2087":"7","\u247a":"7","\u2466":"7","\u2467":"8","\u248f":"8","\u24fc":"8","\u247b":"8","\u2078":"8","\uff18":"8","\u277d":"8","\u2088":"8",
"\u24fd":"9","\uff19":"9","\u2490":"9","\u277e":"9","\u247c":"9","\u2089":"9","\u2468":"9","\u2079":"9"};return function(f){for(var e=f.split(""),c=e.length-1,d=!1,g;0<=c;c--)g=e[c],b.hasOwnProperty(g)&&(e[c]=b[g],d=!0);d&&(f=e.join(""));return f}}).filter("sortBr",["removeDiacriticsFilter",function(b){return function(f,e,c){f.sort(function(d,g){var a=e===k?b(d).toLowerCase():b(d[e]).toLowerCase(),l=e===k?b(g).toLowerCase():b(g[e]).toLowerCase();return c?a<=l?1:-1:a>=l?1:-1});return f}}])})(window.angular);(function(b,k){b.module("app.filters").filter("duplicates",function(){return function(b,f){var e=[],c=b.filter(function(c,g){return b.indexOf(c)!==g?(e.push(g),!0):!1});return f?e:c}}).filter("removeDuplicates",["duplicatesFilter",function(b){return function(f){b(f,!0).sort(function(b,c){return c-b}).forEach(function(b){f.splice(b,1)});return f}}])})(window.angular);(function(b,k){b.module("app.filters").filter("groupBy",function(){return function(b,f){var e={};b.forEach(function(c){var d=JSON.stringify(f(c));e[d]=e[d]||[];e[d].push(c)});return Object.keys(e).map(function(c){return e[c]})}})})(window.angular);(function(b,k){b.module("app.filters").filter("safellyRemove",function(){return function(b,f){var e=b.indexOf(f);-1<e&&b.splice(e,1);return b}})})(window.angular);(function(b,k){b.module("app.storage",[]).constant("nomeEntidades","atividade atividadeTarefa cenario cenarioValor empresa funcao obra tarefa".split(" ")).constant("abbr",{database:"db",usuarios:"us",levantamentos:"lv",datas:"dt",dados:"dd",atividade:"av",atividadeTarefa:"at",cenario:"cn",cenarioValor:"cv",empresa:"em",funcao:"fc",obra:"ob",tarefa:"tf",recursos:"lr",cenarios:"lc",producao:"lp"}).constant("extenso",{db:"database",us:"usuarios",lv:"levantamentos",dt:"datas",dd:"dados",av:"atividade",
at:"atividadeTarefa",cn:"cenario",cv:"cenarioValor",em:"empresa",fc:"funcao",ob:"obra",tf:"tarefa",lr:"recursos",lc:"cenarios",lp:"producao"}).constant("ordem",{atividade:"AtividadePaiId AtividadesFilhas AtividadesTarefa Cor DataAtualizacao DuracaoMaxima DuracaoMinima Id Nome Status".split(" "),atividadeTarefa:"Atividade AtividadeId DataAtualizacao DataCriacao Id Levantamentos ParticipaQS PercentualQS PercentualQS2 PercentualQS3 Status Tarefa TarefaId".split(" ")})})(window.angular);(function(b,k){b.module("app.storage").factory("Storage",["localStorageService",function(n){var f={},e={cenario:function(c){var d="Id Nome Descricao Obrigatorio UserId Usuario DataCriacao DataAtualizacao Status Valores".split(" ");b.isArray(c);var g=[];Object.keys(c).forEach(function(a){var b=c[a],e=[];Object.keys(b).forEach(function(a){var c=d.indexOf(a);e[c]=b[a]});g.push(e)});return g}};return{get:function(c){if(f[c])return f[c];var d=n.get(c);return"function"===typeof e[c]?e[c](d):d},set:function(c,
d){f[c]=d;var b="function"===typeof e[c]?e[c](d):d;n.set(c,b);return b}}}])})(window.angular);(function(b,k){b.module("app.storage").factory("Sessions",["$q","$timeout","localStorageService","RecursosModel",function(n,f,e,c){function d(a){this.DataInicio=this.Id=a||(new Date).toISOString();return this}function g(c){var b=n.defer(),d=[];c&&0!==c.length||b.resolve();c.forEach(function(c){d.push(a(c))});n.all(d).then(function(a){a=a.filter(function(a){return!!a});b.resolve(a)});return b.promise}function a(a){return a.post().then(function(c){return 200===c.status||500===c.status&&c.data.InnerException&&
c.data.InnerException.InnerException&&c.data.InnerException.InnerException.ExceptionMessage&&0===c.data.InnerException.InnerException.ExceptionMessage.indexOf("Cannot insert duplicate key row in object")?!1:a})}function l(a,c){return{value:a,enumerable:!!c}}var p={restore:function(a){var c=new d(a.Id);c.DataFim=a.DataFim;c.setConfig(a.Config);c.setRecursos(a.Recursos);return c},current:function(){return m},save:function(){m.DataFim=(new Date).toISOString();e.set("sessions",h)}},m=null,h={},r=null;
Object.defineProperties(d.prototype,{updateDataFim:l(function(){var a=this;p.save();f(function(){a.updateDataFim()},9E5);return a}),setConfig:l(function(a){var c={};b.extend(c,a);this.Config=c;return this}),setRecursos:l(function(a){var b=this;if(a&&0!==a.length)return b.Recursos=a.filter(function(a){return a&&0!==Object.keys(a).length?!0:!1}).map(function(a){a=c["new"](a);return a.isOpen()?a.close(new Date(b.DataFim)):a}).filter(function(a,c,b){return b.indexOf(a)===c}),b;b.Recursos=[]}),saveConfig:l(function(a){this.Config=
a;p.save();return this}),saveRecursos:l(function(){this.Recursos=b.copy(c.all()).map(function(a){a.Atividade&&(delete a.Atividade,a.Comentarios&&b.isArray(a.Comentarios)&&(a.Comentarios=a.Comentarios.map(function(a){delete a.Membros;return a})));return a});p.save();return this}),endSession:l(function(){var a=this,c=n.defer(),b={};b.Recursos=g(a.Recursos);n.all(b).then(function(b){c.resolve({session:a,value:b})});return c.promise}),checkRelevance:l(function(){return this.Recursos&&this.Recursos.length||
this.Producao&&this.Producao.length||this.Cenarios&&this.Cenarios.length?!0:(delete r[this.Id],!1)})});(function(){r=(r=e.get("sessions"))?r:{};var a={};Object.keys(r).forEach(function(b){var d=p.restore(r[b]);a[d.Id]=d.endSession().then(function(a){a.session.Recursos=a.value;var d=a.session.checkRelevance();c.reset();d?r[b]=a.session:delete r[b]})});n.all(a)["finally"](function(){b.extend(h,r);p.save()});m=new d;m.updateDataFim();return h[m.Id]=m})();return p}])})(window.angular);(function(b,k){b.module("app.directives",["app.core"])})(window.angular);(function(b,k){b.module("app.directives").directive("formReset",function(){return{restrict:"A",link:function(b,f){console.log(f,f.find("input"));b.$on("form:reset",function(){f.find("input").removeClass("ng-touched").removeClass("ng-dirty");console.log(f,f.find("input"))})}}})})(window.angular);(function(b,k){b.module("app.directives").directive("loader",function(){return{restrict:"AE",replace:!0,template:'<div class="spinner-container"><div class="spinner"><div class="spinner-container container1"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container2"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div><div class="spinner-container container3"><div class="circle1"></div><div class="circle2"></div><div class="circle3"></div><div class="circle4"></div></div></div></div>',
link:function(b,f){f.addClass("ng-hide");b.$on("loader:show",function(){return f.removeClass("ng-hide")});b.$on("loader:hide",function(){return f.addClass("ng-hide")})}}})})(window.angular);(function(b,k){function n(f,e){var c=[];this.collapse={show:!1,toggle:function(){this.show=!this.show;this.execute(this.show)},close:function(){this.show=!1;this.execute()},register:function(b){c.push(b)},unregister:function(d){c=c.map(function(c){return c===d?b.noop:c})},execute:function(b){c.forEach(function(c){c(b,f)})}};e.open&&(this.collapse.show=!0);e.scroll&&(this.scroll=e.scroll);return this}b.module("app.directives").directive("listCollapse",["$rootScope",function(f,e,c){function d(c,a,d){function e(c){"input"===
c.target.nodeName.toLowerCase()?c.preventDefault():(m.toggle(),f.$broadcast(h,a))}var m=c.listCollapse.collapse;d=d.listCollapse;var h="listCollapse:close"+(d?":"+d:d);a.on("click",e);c.$on(h,function(c,b){a!==b&&m.close();return!0});c.$on("scroll",function(c,d,l){a===d&&b.element("body").animate({scrollTop:l-112});return!0});c.$on("$destroy",function(){a.off("click",e);c.listCollapse=null})}return{restrict:"A",compile:function(){return{pre:d}},controller:["$element","$attrs",n],scope:{},controllerAs:"listCollapse",
bindToController:!0}}]).directive("listCollapseItem",["$rootScope","$timeout","Velocity",function(f,e,c){return{restrict:"A",require:"^listCollapse",scope:{},link:function(d,e,a,l){function p(a,c){return a?q(c):t(c)}function m(a){c(e,{width:"100%",opacity:1},{duration:150,queue:!1});c(e,"slideDown",{duration:300,complete:function(){f.$broadcast("scroll",a,e.position().top)}})}function h(){c(e,"slideUp",{duration:250});c(e,{width:0,opacity:0},{duration:150,delay:100,queue:!1})}a="string"!==typeof a.invertItem;
var r=b.element("#"+l.scroll);parseInt(r.css("padding-top"),10);var q=a?m:h,t=a?h:m;l.collapse.register(p);e.css({display:"none"});d.$on("$destroy",function(){l.collapse.unregister(p);r=null})}}}])})(window.angular);(function(b,k){b.module("app.directives").directive("blacklist",function(){return{require:"ngModel",scope:{blacklist:"=",ngModel:"="},link:function(b,f,e,c){var d=b.blacklist;c.$parsers.unshift(function(b){var a=-1===d.indexOf(b);c.$setValidity("blacklist",a);return a?b:k});c.$formatters.unshift(function(b){c.$setValidity("blacklist",-1===d.indexOf(b));return b})}}})})(window.angular);(function(b){b.module("app.directives").directive("sidebar",["$rootScope",function(b){return{restrict:"C",link:function(n,f){b.$watch("sidebarOpen",function(b,c){if(b!==c)return b?f.addClass("open"):f.removeClass("open")});f.on("click",function(){b.sidebarOpen=!1})}}}])})(window.angular);(function(b,k){b.module("app.layout",[])})(window.angular);(function(b,k){b.module("app.layout").controller("Toolbar",["$scope","$state",function(b,f){return this}])})(window.angular);(function(b,k){b.module("app.layout").controller("Configuracao",["$scope","filterFilter","sortBrFilter","dados","ConfigurationService","session",function(n,f,e,c,d,g){function a(a,c){return c?a.filter(function(a){return-1<c.indexOf(a.Id)}):[]}function l(a,c,d){if(!a||!a.target||"input"!==a.target.tagName.toLowerCase())if(h.buttons.ok.disabled=!0,!b.equals(h.selected[c],d))return h.selected[c]=d,a=r[c.toLowerCase()](d),a.array&&1===a.array.length&&h.select(null,a.filha,a.array[0]),a.array}function p(b,
d){if(!b||!b.target||"input"!==b.target.tagName.toLowerCase()){q=!0;h.buttons.ok.disabled=!0;var g=f(c.obra,{ObraId:d.Id});h.selected.obras=h.selected.obras||[];var r;h.selected.obras.forEach(function(a,c){a.ObraId===d.ObraId&&(r=c)});"undefined"!==typeof r&&(h.selected.obras.length=r);h.selected.obras.push(d);switch(h.selected.obras.length){case 1:h.selected.Empreendimento=d;m("Obra");m("Fracao","Fracoes");m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");break;case 2:h.selected.Obra=d;m("Fracao",
"Fracoes");m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");break;case 3:h.selected.Fracao=d;m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");break;case 4:h.selected.Subfracao=d,m("Contratada"),m("Tarefa")}h.Obras=e(g,"Nome");if(1===g.length)return b&&b.stopPropagation(),p(null,g[0]);if(g.length)return b&&b.stopPropagation(),h.Obras;h.Contratadas=a(c.empresa,d.Contratadas);h.Contratadas=e(h.Contratadas,"RazaoSocial");1===h.Contratadas.length&&l(null,"Contratada",h.Contratadas[0]);q=
!1;return!0}}function m(a,c){"Tarefa"===a&&h.selected.Tarefa&&(d.unset(),g.saveConfig(d.full(!0)));c||(c=a+"s");return h[c]=0&delete h.selected[a]}var h=this;n=c.obra.map(function(a){return a.EmpresaId});var r={empresa:function(b){m("Empreendimento");m("Obra");m("Fracao","Fracoes");m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");h.Obras=a(c.obra,b.Obras).filter(function(a){return null===a.ObraId});e(h.Obras,"Nome");return{array:h.Obras,filha:"Obra"}},empreendimento:function(b){m("Obra");m("Fracao",
"Fracoes");m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");h.Obras=f(c.obra,{ObraId:b.Id});e(h.Obras,"Nome");return h.Obras.length?{array:h.Obras,filha:"Fracao"}:(h.Contratadas=a(c.empresa,h.selected.Empreendimento.Contratadas),e(h.Contratadas,"RazaoSocial"),{array:h.Contratadas,filha:"Contratada"})},obra:function(b){m("Fracao","Fracoes");m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");h.Fracoes=f(c.obra,{ObraId:b.Id});e(h.Fracoes,"Nome");return h.Fracoes.length?{array:h.Fracoes,filha:"Subfracao"}:
(h.Contratadas=a(c.empresa,h.selected.Obra.Contratadas),e(h.Contratadas,"RazaoSocial"),{array:h.Contratadas,filha:"Contratada"})},fracao:function(b){m("Subfracao","Subfracoes");m("Contratada");m("Tarefa");h.Subfracoes=f(c.obra,{ObraId:b.Id});e(h.Subfracoes,"Nome");return h.Subfracoes.length?{array:h.Subfracoes,filha:"Contratada"}:(h.Contratadas=a(c.empresa,h.selected.Obra.Contratadas),e(h.Contratadas,"RazaoSocial"),{array:h.Contratadas,filha:"Contratada"})},subfracao:function(b){m("Contratada");m("Tarefa");
h.Contratadas=a(c.empresa,h.selected.Obra.Contratadas);e(h.Contratadas,"RazaoSocial");return{array:h.Contratadas,filha:"Contratada"}},contratada:function(b){m("Tarefa");h.Tarefas=a(c.tarefa,h.selected.Contratada.Tarefas);e(h.Tarefas,"Nome");return{array:h.Tarefas,filha:"Tarefa"}},tarefa:function(a){h.buttons.ok.disabled=!1;Object.keys(h.selected).forEach(function(a){d.select(a,h.selected[a])});g.saveConfig(d.full(!0));return{array:[],filha:""}}},q=!1;b.extend(h,{buttons:{ok:{disabled:!0}},selected:{},
select:l,selectObra:p,rebuildLevel:function(a,b){if(!b)return h;q&&a.stopPropagation();h.Obras=e(c.obra.filter(function(a){return a.ObraId===b.ObraId}),"Nome");return h},isSelected:function(a,b){return a&&b&&a===b},Empresas:[],Empreendimentos:[],Obras:[],Fracoes:[],Subfracoes:[],Contratadas:[],Tarefas:[]});h.Empresas=a(c.empresa,n);e(h.Empresas,"RazaoSocial");1===h.Empresas.length&&h.select(null,"Empresa",h.Empresas[0])}])})(window.angular);(function(b,k){b.module("app.layout").controller("equipeController",["funcoes","sortBrFilter","Equipe","safellyRemoveFilter",function(n,f,e,c){function d(){a.showForm=!1;a.trabalhador={Nome:"",experiencia:{tempo:"",unidade:"anos"},Funcao:""};return!0}function g(){a.nomes=a.trabalhadores.map(function(a){return a.Nome});return a.nomes}var a=this;a.funcoes=n;a.trabalhadores=e.all();a.nomes=[];g();b.extend(a,{formulario:function(b){a.showForm=!0;a.trabalhador.Funcao=b;a.trabalhador.Nome=b.Nome+" "+(b.Membros?
b.Membros.length+1:1);return!0},adicionar:function(){var b={Nome:a.trabalhador.Nome,Funcao:a.trabalhador.Funcao,Experiencia:a.trabalhador.experiencia.tempo};e.add(b);a.updateNomes();d();return b},remover:function(b){e.remove(b);c(a.nomes,b.Nome);a.updateNomes();return!0},cancelar:d,showExp:function(a){a=12*parseInt(a,10);var b=Math.floor(a/12);a%=12;return(b||a?" \u2022 ":"")+(b?b+(1<b?" anos":" ano"):"")+(b&&a?" e ":" ")+(a?a+(1<a?" meses":" m\u00eas"):"")},updateNomes:g});d();return a}])})(window.angular);(function(b,k){b.module("app.layout").controller("recursosController",["$scope","$state","$modal","Equipe","AtividadesService","Levantamentos","authservice",function(b,f,e,c,d,g,a){function l(){e.open({template:'<div class="modal-header section"><h3 class="modal-title section-content section-content-header">Selecione sua pr\u00f3xima a\u00e7\u00e3o:</h3></div><div class="modal-footer section"><button class="btn btn-cancel" ng-click="cancel()">Continuar</button><button class="btn btn-ok" ng-click="ok()">Fazer logoff</button></div>',
size:"lg",controller:["$scope","$modalInstance",function(a,b){a.ok=function(){b.close()};a.cancel=function(){b.dismiss("cancel")}}]}).result.then(function(){c.reset();a.logout()},function(){c.aguardando();f.reload()})}var p=this;p.Atividades=d.delegaveis().filter(function(a){return a.Membros&&a.Membros.length});p.Equipe=c.all();p.change=function(a,b,d){a.stopPropagation();c.select(b);f.go(d)};p.finalizar=function(a){return g.send(a)["finally"](function(){l()})};p.openModal=function(){e.open({template:'<div class="modal-header section"><h3 class="modal-title section-content section-content-header">Qual hor\u00e1rio de fechamento das atividades?</h3></div><div class="modal-body section-content"><timepicker ng-model="horario" hour-step="1" minute-step="1" show-meridian="ismeridian"></timepicker></div><div class="modal-footer section"><button class="btn btn-cancel" ng-click="cancel()">Cancelar</button><button class="btn btn-ok" ng-click="ok()">OK</button></div>',
size:"sm",controller:["$scope","$modalInstance","horario",function(a,b,c){a.horario=c;a.ok=function(){b.close(a.horario)};a.cancel=function(){b.dismiss("cancel")}}],resolve:{horario:function(){return new Date}}}).result.then(function(a){p.finalizar(a||new Date)},function(){console.info("Modal dismissed at: "+new Date)})};b.horario=null}])})(window.angular);(function(b,k){b.module("app.layout").controller("atividadesController",["$state","filterFilter","sortBrFilter","Equipe","AtividadesService","Levantamentos",function(n,f,e,c,d,g){function a(){p.selecao=e(p.Atividades,"Nome");return p}function l(){c.deselectAll();p.selected.Atividade=[];return!0}var p=this,m=new Date;b.extend(p,{Atividades:d.gerais(),Equipe:c.all(),selected:{Atividade:[],Equipe:c.getSelecionados()},selecao:[],select:function(a,b){if("input"!==a.target.tagName.toLowerCase()){if(b.AtividadesFilhas.length)return a.stopPropagation(),
p.selecao=b.AtividadesFilhas,p.selected.Atividade.push(b),!0;p.selecao=[];p.selected.Atividade.push(b);return!0}},toggle:function(a,b){"label"===a.target.tagName.toLowerCase()&&a.preventDefault();if("input"!==a.target.tagName.toLowerCase())return b.isSelected?c.deselect(b):c.select(b)},reset:l,registrar:function(){var a=p.selected.Atividade.pop();p.selected.Equipe.filter(function(b){return b.Atividade===a}).forEach(function(a){c.deselect(a)});g.recursos.registrar(p.selected.Equipe,a,m);c.setAtividade(p.selected.Equipe,
a);l()},rebuildLevel:function(b){p.selected.Atividade.length=p.selected.Atividade.indexOf(b);if(null===b.AtividadePaiId)return a();p.selecao=e(p.atividades.delegaveis.filter(function(a){return a.AtividadePaiId===b.AtividadePaiId}),"Nome");return p}});a();return p}])})(window.angular);(function(b,k){b.module("app.layout").controller("comentariosController",["$state","$timeout","Equipe","Comentarios","Sessions",function(n,f,e,c,d){function g(){e.deselectAll();a.texto="";return!0}var a=this;b.extend(a,{Equipe:e.all(),selected:{Equipe:e.getSelecionados()},div:[],Texto:"",toggle:function(a,b){if(!a||!a.target||"input"!==a.target.tagName.toLowerCase())return b.isSelected?e.deselect(b):e.select(b)},reset:g,gravar:function(){var b=c["new"](a.texto);a.selected.Equipe.forEach(function(a){a.addComentario(b)});
d.current().saveRecursos();g()}});return a}])})(window.angular);(function(b){b.module("app.layout").controller("cenariosController",["$state","$modal","cenariosService","safellyRemoveFilter",function(k,n,f,e){function c(){a&&(b.element("#tabs").removeClass("hidden-tabs"),b.element("main").addClass("hidden-tabs"),a=!1)}function d(){g.forEach(function(a){a.selectValor(a.OldValue);a.pristine()});g=[];c();return!0}b.extend(this,{todos:f.all(),select:function(d,f,m){d&&d.target&&"input"===d.target.tagName.toLowerCase()||(f.selectValor(m),f.isDirty?g.push(f):e(g,f),
g.length?a||(b.element("#tabs").addClass("hidden-tabs"),b.element("main").addClass("hidden-tabs"),a=!0):c())},reset:d,gravar:function(){var a=new Date;g=g.map(function(b){return b.update(a)}).filter(function(a){return a.isDirty});d();k.go("recursos")}});var g=[],a=!1;return this}])})(window.angular);(function(b){b.module("app.layout").factory("cenariosService",["$q","Entidades","ConfigurationService","Sessions","Cenario","sortBrFilter","safellyRemoveFilter",function(b,n,f,e,c,d,g){var a={},l=[],p={all:function(){0===l.length&&(l=Object.keys(a).map(function(b){return a[b]}),l=d(l,"Nome"));return l},reset:function(){Object.keys(a).forEach(function(b){a[b].reset()});return a={}},send:function(c){var d=b.defer(),e={};Object.keys(a).forEach(function(b){var d=a[b].Registros;e[b]=[];d.forEach(function(a){e[b].push(a.send(c))})});
b.all(e).then(function(a){a=Object.keys(a).map(function(b){return a[b].filter(function(a){return!!a})});d.resolve(a)});return d.promise}};(function(){var b=f.select("Tarefa"),d=n.get("cenarioValor",b.CenariosValor,!0),b=Object.keys(d).map(function(a){return d[a].CenarioId}).filter(function(a,b,c){return c.indexOf(a)===b});n.get("cenario",b).map(function(a){return c["new"](a)}).forEach(function(b){a[b.Id]=b});return p})();return p}])})(window.angular);(function(b,k){b.module("app.layout").factory("Cenario",["Entidades","ConfigurationService","Sessions","dataservice",function(b,f,e,c){function d(a){this.Id=a.Id;this.Nome=a.Nome;this.CenariosValor=[];this.setCenariosValor();this.OldValor=this.selectedValor=null;this.selectValor(null);this.Registros=[];this.RegistroAtual=null;this.resetRegistros();return this}function g(a,b){this.Inicio=b;this.Fim=null;this.CenarioValorId=a;this.UserId=m.UsuarioId;this.ObraId=m.ObraId;this.EmpresaId=m.EmpresaId;this.TarefaId=
m.TarefaId;this.DataAtualizacao=this.DataCriacao=b;return this}function a(a,b){return{value:a,enumerable:!!b}}var l={"new":function(a){return new d(a)}},p={},m={},h=null;Object.defineProperties(d.prototype,{setCenariosValor:a(function(){var a=this;this.CenariosValor=Object.keys(p).filter(function(b){return p[b].CenarioId===a.Id}).map(function(a){return p[a]});return this}),unsetCenariosValor:a(function(){this.CenariosValor=[]}),selectValor:a(function(a){a!==this.selectedValor&&(this.selectedValor=
a);this.checkIfIsDirty();return this}),unselectValor:a(function(){this.selectValor(null);return this}),setOldValor:a(function(a){if(a!==this.OldValor)return this.OldValor=a,this}),checkIfIsDirty:a(function(){this.isDirty=this.selectedValor!==this.OldValor;return this}),pristine:a(function(){this.isDirty&&this.setOldValor(this.selectedValor);this.isDirty=!1;return this}),openRegistro:a(function(a){this.Registros&&0!==this.Registros.length||(a=h);this.RegistroAtual=new g(this.Id,a);this.Registros.push(this.RegistroAtual);
return this}),closeRegistro:a(function(a){this.RegistroAtual&&this.RegistroAtual.close(a);this.RegistroAtual=null;return this}),resetRegistros:a(function(){this.Registros=[];this.RegistroAtual=null;return this}),update:a(function(a){this.closeRegistro(a);this.openRegistro(new Date(a.getTime()+1E3));this.pristine();return this}),reset:a(function(){this.unselectValor();this.unsetCenariosValor();this.resetRegistros();return this}),toString:a(function(){return this.selectedValor?this.Nome+": "+this.selectedValor.Nome:
""}),marker:a(function(){return this.Nome.charAt(0).toUpperCase()}),showMarker:a(function(a,b){return 0===b?!0:a[b-1].marker()!==this.marker()})});Object.defineProperties(g.prototype,{close:a(function(a){this.DataAtualizacao=this.Fim=a=a.toISOString();return this}),send:a(function(a){a=a.toISOString();var b={Inicio:this.Inicio,Fim:a,CenarioValorId:this.CenarioValorId,UserId:this.UserId,ObraId:this.ObraId,EmpresaId:this.EmpresaId,TarefaId:this.TarefaId,DataCriacao:this.DataCriacao,DataAtualizacao:a};
return c.post("cenariodia",b).then(function(a){return!1})["catch"](function(a){return b})})});(function(){var a=f.select("Tarefa");p=b.get("cenarioValor",a.CenariosValor.concat(a.AtributosProducao),!0);h=e.current().DataInicio;m=f.full(!0);return l})();return l}])})(window.angular);(function(b,k){b.module("app.layout").factory("producaoService",["$q","Entidades","ConfigurationService","Cenario","ProdutoModel","sortBrFilter",function(b,f,e,c,d,g){function a(a,b){this.Unidade=a;this.Valor=b;return this}var l={Produtos:{all:function(){return p},create:function(a){a=d["new"](a);p.push(a);m.push(a.Identificadores);return a},remove:function(a){safellyRemove(p,a);safellyremove(m,a.Identificadores);return a},get:function(a){return p.filter(function(b){return b.Id===parseInt(a,10)})[0]},
send:function(a){var c=b.defer(),d=[];p.forEach(function(b){d.push(b.send(a))});b.all(d).then(function(a){a=a.filter(function(a){return!!a});c.resolve(a)});return c.promise}},Atributos:{all:function(){return h},reset:function(){h.forEach(function(a){a.reset()});return h}},Nomes:{all:function(){return m},registrar:function(a){m.push(a.Identificadores);return m},remover:function(a){safellyRemove(m,a.Identificadores);return m}},QS:{all:function(){return r},reset:function(){return r=[]}}},p=[],m=[],h=
[],r=[];Object.defineProperties(a.prototype,{updateValor:{value:function(a){this.Valor="m2"===a?"m\u00b2":a;return this},enumerable:!1},reset:{value:function(){this.Valor=k},enumerable:!1},toString:{value:function(){return typeof this.Valor===k?"":this.Valor+" "+this.Unidade},enumerable:!1}});(function(){var b=e.select("Tarefa"),d=f.get("cenarioValor",b.AtributosProducao,!0),m=Object.keys(d).map(function(a){return d[a].CenarioId}).filter(function(a,b,c){return c.indexOf(a)===b});f.get("cenario",m).map(function(a){return c["new"](a)}).forEach(function(a){h.push(a)});
h=g(h,"Nome");["UnidadeMedida","UnidadeMedida2","UnidadeMedida3"].forEach(function(c){""!==b[c]&&r.push(new a(b[c]))});return l})();return l}])})(window.angular);(function(b,k){b.module("app.layout").controller("producaoController",["$state","producaoService",function(n,f){b.extend(this,{produtos:f.Produtos.all(),atualizar:function(b,c){return n.go("produto",{id:c.Id})},edit:function(b,c){b.stopPropagation();return n.go("produtoEdit",{id:c.Id})}});return this}])})(window.angular);(function(b,k){b.module("app.layout").factory("ProdutoModel",["Entidades","ConfigurationService","Sessions","Cenario","dataservice",function(n,f,e,c,d){function g(a){this.Id=++p;this.Identificadores=a.Identificadores;this.Atributos=[];this.Medicao=[];this.setAtributos(a.Atributos);this.setMedicao(a.Medicao);return this}function a(a,b){return{value:a,enumerable:!!b}}var l={"new":function(a){return new g(a)}},p=0,m=[],h={},k=null;Object.defineProperties(g.prototype,{setAtributos:a(function(a){this.Atributos=
b.copy(a)||[]}),sendAtributos:a(function(){return this.Atributos.filter(function(a){return a.selectedValor||0===a.selectedValor}).map(function(a){return a.selectedValor.Id})}),setMedicao:a(function(a){this.Medicao=b.copy(a)||[]}),send:a(function(a){a=a.toISOString();var b=this.sendAtributos(),c={QS1:b[0]||0,QS2:b[1]||0,QS3:b[2]||0,ObraId:h.ObraId,TarefaId:h.TarefaId,EmpresaId:h.ContratadaId,UserId:h.UsuarioId,Inicio:k,DataCriacao:k,Fim:a,DataAtualizacao:a};return d.post("producao",c).then(function(a){return!1})["catch"](function(a){return c})})});
(function(){var a=f.select("Tarefa");m=n.get("cenarioValor",a.AtributosProducao,!0);a=Object.keys(m).map(function(a){return m[a].CenarioId}).filter(function(a,b,c){return c.indexOf(a)===b});n.get("cenario",a).map(function(a){return c["new"](a)});h=f.full(!0);k=e.current().DataInicio;return l})();return l}])})(window.angular);(function(b,k){b.module("app.layout").controller("produtoController",["Produto","ProdutoModel","producaoService",function(n,f,e){function c(){d.Atributos.forEach(function(b){b.unselectValor()});d.Medicao.forEach(function(b){b.reset()});return d}var d=this;b.extend(d,{Nomes:e.Nomes.all(),Atributos:e.Atributos.all(),Medicao:e.QS.all(),Identificadores:"",instance:null,select:function(b,a,c){return a.selectValor(c)},gravar:function(){var b=e.Produtos.create(d);c();return b},cancel:c});n&&(b.copy(n),b.extend(d,
n),d.instance=n);return d}])})(window.angular);(function(b,k){b.module("app.layout").controller("toolbarController",["$state","$rootScope",function(n,f){b.extend(this,n.$current.data.toolbar);this.toggleSidebar=function(){f.sidebarOpen=!f.sidebarOpen};return this}])})(window.angular);(function(b,k){b.module("app.layout").controller("footerController",["$scope","$state",function(n,f){this.buttons={};b.extend(this.buttons,n.$parent.buttons);var e=f.$current.data.footer.buttons||{},c=this.buttons;Object.keys(e).forEach(function(b){var g=e[b];if(c[b]){var a=c[b];Object.keys(g).forEach(function(b){0!==b.indexOf("$$")&&"undefined"===typeof a[b]&&(a[b]=g[b])})}});return this}])})(window.angular);(function(b,k){b.module("app.layout").controller("sidebarController",["$rootScope","authservice","User",function(b,f,e){b.showSidebar=!1;this.UserName=e.getName();this.logout=f.logout;this.toggleSidebar=function(){b.showSidebar=!b.showSidebar};return this}])})(window.angular);(function(b,k){b.module("app.auth",[])})(window.angular);(function(b,k){b.module("app.auth").controller("Login",["$scope","$state","authservice","logger","$http",function(b,f,e,c,d){function g(){a.login=a.login||{};a.login.UserName="";a.login.Password=""}var a=this;a.submit=function(){return e.login(a.login).then(function(){c.success("Login realizado com sucesso!",null,"login.js: login");f.go("configuracao")})["catch"](function(a){g();c.warn(a,null,"login.js: login")})};g();return a}])})(window.angular);(function(b,k){b.module("app.auth").factory("authservice",["$state","logger","dataservice","User","localStorageService",function(n,f,e,c,d){var g,a;function l(){g=!1;a=null;c.reset();return n.go("login")}var p="";a=g=void 0;var m={login:function(h){function f(e){g=!0;a||(a="server");var h=c.register(e),l=d.get("users")||[],m=l.filter(function(a){return c.checkId(a)});m.length?b.extend(m[0],h):h.UserId&&0===l.filter(function(a){return a.UserId===h.UserId}).length&&l.push(h);d.set("users",l);return e}
function m(a){l();throw Error(a);}p=h.Password;c.register(h);return e.requestToken(c.getName(),p).then(f)["catch"](function(b){if(b&&500===b.status&&b.data&&"Login falhou"===b.data.ExceptionMessage)return m(b.data.ExceptionMessage);b=d.get("users")||[];var e=b.filter(function(a){return c.identify(a)});1<e.length&&(e=e.reduce(function(a,b){return a.Expiracao>b.Expiracao?a:b}),b=b.filter(function(a){return a.Id!==e.Id}));if(1===e.length)return a="local",f(e)})},logout:l,isLogged:function(){return g},
loginMethod:function(){return a}};l();f.info("initialized",null,"authservice.js: init");return m}])})(window.angular);(function(b,k){b.module("app.models",[])})(window.angular);(function(b,k){b.module("app.models").factory("Membros",["sortBrFilter","safellyRemoveFilter",function(n,f){function e(b){this.Nome=b.Nome;this.Experiencia=b.Experiencia;this.isSelected=!1;this.setFuncao(b.Funcao);this.setAtividade(b.Atividade);this.setRecurso(null);return this}function c(b,c){return{value:b,enumerable:!!c}}Object.defineProperties(e.prototype,{setFuncao:c(function(b){this.Funcao=b;b.Membros=b.Membros||[];b.Membros.push(this);b.Membros=n(b.Membros,"Nome");return this}),unsetFuncao:c(function(){var b=
this.Funcao;this.Funcao=null;f(b.Membros,this);return this}),setAtividade:c(function(b){this.Atividade=b;b.Membros=b.Membros||[];b.Membros.push(this);b.Membros=n(b.Membros,"Nome");return this}),unsetAtividade:c(function(){var b=this.Atividade;this.Atividade=null;f(b.Membros,this);return this}),changeAtividade:c(function(b){this.Atividade!==b&&(this.unsetAtividade(),this.setAtividade(b));return this}),addComentario:c(function(b){if(!this.Recurso)return this;this.Recurso.addComentario(b);b.addMembro(this);
return this}),removeComentario:c(function(b){if(!this.Recurso)return this;this.Recurso.removeComentario(b);b.removeMembro(this);return this}),removeTodosComentarios:c(function(){if(!this.Recurso)return this;b.isArray(this.Recurso.Comentarios)&&b.copy(this.Recurso.Comentarios).forEach(function(b){this.removeComentario(b)});return this}),setRecurso:c(function(b){this.Recurso=b}),unsetRecurso:c(function(){this.Recurso=null}),select:c(function(){this.isSelected=!0;return this}),deselect:c(function(){this.isSelected=
!1;return this}),printRegistros:c(function(){var b="";this.Recurso&&this.Recurso.Comentarios&&this.Recurso.Comentarios.length&&(b=1===this.Recurso.Comentarios.length?" \u2022 1 coment\u00e1rio":" \u2022 "+this.Recurso.Comentarios.length+" coment\u00e1rios");return this.Funcao.Nome+b}),"delete":c(function(){this.unsetAtividade();this.unsetFuncao();this.removeTodosComentarios();this.unsetRecurso();return this})});return{"new":function(b){return new e(b)}}}])})(window.angular);(function(b,k){b.module("app.models").factory("Comentarios",["sortBrFilter","safellyRemoveFilter",function(n,f){function e(a){this.Id="c_"+ ++d;this.value=a;this.Membros=[];this.setValue(a);this.queue();return this}function c(a,b){return{value:a,enumerable:!!b}}var d=0,g=[];Object.defineProperties(e.prototype,{addMembro:c(function(a){b.isArray(a)?this.Membros=this.Membros.concat(a):this.Membros.push(a);this.Membros=n(this.Membros,"Nome");return this}),removeMembro:c(function(a){a=b.isArray(a)?a:[a];
a.forEach(function(a){f(this.Membros,a)});0===this.Membros.length&&this.unqueue();return this}),setValue:c(function(a){this.value=a;return this}),unsetValue:c(function(){this.value="";return this}),queue:c(function(){g.push(this);return this}),unqueue:c(function(){f(g,this);return this}),printMembros:c(function(){return this.Membros.map(function(a){return a.Nome}).join(", ")}),"delete":c(function(){this.Membros.forEach(function(a){a.removeComentario(this)});this.unsetValue();this.unqueue();return g})});
return{all:function(){return g},"new":function(a){return new e(a)}}}])})(window.angular);(function(b,k){b.module("app.services",[])})(window.angular);(function(b,k){function n(f,e,c){function d(){return a.UserName||""}function g(){return a.Password||""}var a={};this.register=function(c){b.isArray(c)&&(c=c[0]);b.extend(a,c);a.Password===c.Password&&(a.Password=c.Password?f.hash(c.Password):"");return a};this.reset=function(){a={}};this.getId=function(){return a.UserId||""};this.getToken=function(){return a.Token||""};this.getName=d;this.getPassword=g;this.getLoginData=function(){return{UserName:d(),Password:g()}};this.getData=function(){return{Empresas:a.Empresas,
Obras:a.Obras,Tarefas:a.Tarefas}};this.identify=function(b){return a.UserName===b.UserName&&a.Password===b.Password};this.checkId=function(b){return a.UserId===b.UserId}}b.module("app.services").service("User",n);n.$inject=["encryptService","dataservice","localStorageService"]})(window.angular);(function(b,k){b.module("app.services").factory("Entidades",["$q","dataservice","localStorageService","hashByIdFilter","unhashByIdFilter","sortBrFilter",function(n,f,e,c,d,g){function a(){function a(d,e){var h=n.defer();f.get(d,{data:e}).then(function(a){return p(a,d)}).then(c).then(function(a){var c=q.dados[d]||{};a=0===Object.keys(a).length?c:b.extend(c,a);return q.dados[d]=a}).then(function(a){k[d]&&delete k[d];a||h.reject("N\u00e3o h\u00e1 dados de "+d);h.resolve(a)})["catch"](function(){h.resolve(q.dados[d])});
return h.promise}var d=n.defer(),g=Object.keys(h),l={},u={};g.forEach(function(a){q.dados[a]=e.get(a)||{};q.datas[a]=e.get(a+"Data")||"2014-01-01T00:00:00"});g.forEach(function(b){l[b]=a(b,q.datas[b]);u[b]=l[b]});n.all(u).then(function(a){g.forEach(function(a){e.set(a,q.dados[a]);e.set(a+"Data",q.datas[a])});return a},function(a){g.forEach(function(a){q.dados[a]=e.get(a)||{};q.datas[a]=e.get(a+"Data")||"2014-01-01T00:00:00"});return q.dados})["finally"](function(){h=q.dados;m=!0;return d.resolve(h)});
return d.promise}function l(b,c,e){if(!m)return a().then(function(){l(b,c)});if(!c||0===c.length)return k[b]||(k[b]=d(h[b])),e?h[b]:k[b];if(e){var g={};c.forEach(function(a){g[a]=h[b][a]});return g}return c.map(function(a){return h[b][a]})}function p(a,b){var c=q.datas[b]||"2014-01-01T00:00:00";a.forEach(function(a){a.DataAtualizacao>c&&(c=a.DataAtualizacao)});q.datas[b]=c;return a}var m=!1,h={atividade:{},atividadeTarefa:{},cenario:{},cenarioValor:{},empresa:{},funcao:{},obra:{},tarefa:{}},k={},
q={dados:{},datas:{}};return{init:a,get:l}}])})(window.angular);(function(b,k){b.module("app.models").factory("ConfigurationService",["$q","Entidades","User",function(b,f,e){function c(){return f.init().then(function(){var b=e.getData();a.empresa=f.get("empresa",b.Empresas);a.obra=f.get("obra",b.Obras);a.tarefa=f.get("tarefa",b.Tarefas);return a})}function d(){return g("Subfracao")||g("Fracao")||g("Obra")||g("Empreendimento")}function g(a,b){return b?l[a]=b:l[a]}var a={empresa:[],obra:[],tarefa:[]},l={},p={get:function(){var a=b.defer();c().then(function(b){a.resolve(b)});
return a.promise},full:function(a){var b=p.select("Tarefa");return b?a?{EmpresaId:p.select("Empresa").Id,ObraId:d().Id,UsuarioId:e.getId(),TarefaId:b.Id,ContratadaId:p.select("Contratada").Id}:{Empresa:p.select("Empresa"),Obra:d(),UsuarioId:e.getId(),Tarefa:b,Contratada:p.select("Contratada")}:{}},select:g,unset:function(){l={}},selected:l};return p}])})(window.angular);(function(b,k){b.module("app.services").factory("Equipe",["Membros","AtividadesService","sortBrFilter","safellyRemoveFilter",function(n,f,e,c){var d=f.aguardando,g=[],a=[];return{add:function(a){a.Atividade=d;g.push(n["new"](a));return g=e(g,"Nome")},remove:function(a){c(g,a);a["delete"]();return g},all:function(){return g},select:function(c){c=b.isArray(c)?c:[c];c.forEach(function(b){a.push(b.select())});return a},deselect:function(d){d=b.isArray(d)?d:[d];d.forEach(function(b){c(a,b.deselect())});
return a},deselectAll:function(){a.forEach(function(a){a.deselect()});return a=[]},getSelecionados:function(){return a},setAtividade:function(c,d){c=b.isArray(c)?c:[c];c.forEach(function(a){a.changeAtividade(d)});return a},aguardando:function(){g.forEach(function(a){a.changeAtividade(d);a.unsetRecurso()})},reset:function(){for(var b=g.length-1;0<=b;b--)g[b]["delete"]();g=[];a=[];return g}}}])})(window.angular);(function(b,k){b.module("app.services").factory("Recursos",["Equipe","Entidades","ConfigurationService","hashByIdFilter","removeDuplicatesFilter",function(b,f,e,c,d){var g={};init();return{atividades:{delegaveis:[],gerais:[],aguardando:null},comentarios:{all:function(){return Object.keys(g).map(function(a){return g[a]})},"new":function(){}}}}])})(window.angular);(function(b,k){b.module("app.services").factory("AtividadesService",["Entidades","ConfigurationService","hashByIdFilter","removeDuplicatesFilter",function(b,f,e,c){function d(a){if(0===a.AtividadesFilhas.length){var c=b.get("atividadeTarefa",a.AtividadesTarefa,!0);a.AtividadeTarefaId=a.AtividadesTarefa.filter(function(a){return c[a].TarefaId===tarefa.Id})[0]}return a}function g(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}var a={Nome:"Aguardando atividade",Id:-1,Membros:[],AtividadePaiId:null,
Cor:"#B0B0BB",DuracaoMinima:0,DuracaoMaxima:0,Status:!0,AtividadesFilhas:[],AtividadesTarefa:[]};e={all:function(){return l},delegaveis:function(){return p},gerais:function(){return m},aguardando:a};var l=[],p=[],m=[];(function(){var e=f.select("Tarefa"),k=c(e.Atividades),e=b.get("atividade",k),q=b.get("atividade",k,!0);e.forEach(function(a){a.Nome=g(a.Nome);a.AtividadesFilhas.map(function(a){return q[a]}).filter(function(a){return a}).forEach(d)});k=c(e.map(function(a){return a.AtividadePaiId}));
k=b.get("atividade",k).map(function(a){a.Nome=g(a.Nome);return a});k.forEach(function(a){a.AtividadesFilhas=a.AtividadesFilhas.map(function(a){return q[a]}).filter(function(a){return a})});l=[a].concat(k).concat(e);p=l.filter(function(a){return 0===a.AtividadesFilhas.length});m=l.filter(function(a){return null===a.AtividadePaiId});return!0})();return e}])})(window.angular);(function(b,k){b.module("app.levantamentos",[])})(window.angular);(function(b,k){b.module("app.levantamentos").factory("Levantamentos",["$q","groupByFilter","RecursosLev","Sessions","cenariosService","producaoService","logger",function(b,f,e,c,d,g,a){return{recursos:{registrar:function(a,b,d){var g=a.map(function(a){return e.close(a.Recurso,d)});a.forEach(function(a){a.Recurso=null});b&&-1<b.Id&&a.forEach(function(a,c){a.Recurso="boolean"!==typeof g[c]?e.open(a,b,g[c]):e.open(a,b,new Date(d.getTime()+1E3))});c.current().saveRecursos();return a}},cenarios:{},producao:{},
send:function(f){var p=b.defer();f={recursos:e.send(f),cenarios:d.send(f),producao:g.Produtos.send(f)};b.all(f).then(function(b){c.current().saveRecursos();a.info("levantamentos salvos",null,"levantamentos.js: send");p.resolve(b)});return p.promise}}}])})(window.angular);(function(b,k){b.module("app.levantamentos").factory("RecursosLev",["$q","ConfigurationService","User","Entidades","RecursosModel",function(k,f,e,c,d){function g(b){if(l[b.Id])return l[b.Id];var d=c.get("atividadeTarefa",b.AtividadesTarefa,!0),e=b.AtividadesTarefa.filter(function(b){return d[b].TarefaId===a.Tarefa.Id})[0];return l[b.Id]=e}var a={},l={};b.extend(a,f.full());return{open:function(b,c,e){e=e.toISOString();b={AtividadeTarefaId:g(c),EmpresaId:a.Empresa.Id,ObraId:a.Obra.Id,UserId:a.UsuarioId,
Atividade:c,TarefaId:a.Tarefa.Id,ContratadaId:a.Contratada.Id,FuncaoId:b.Funcao.Id,Inicio:e,DataCriacao:e,Colaboradores:b.Nome,QuantidadeColaboradores:1,Comentarios:[],status:"open"};return d["new"](b)},close:function(a,b){if(!a)return!0;var c=0===a.Atividade.DuracaoMinima?3E4:1E3*a.Atividade.DuracaoMinima,d=0===a.Atividade.DuracaoMaxima?Number.POSITIVE_INFINITY:1E3*a.Atividade.DuracaoMaxima;if(b-a.toDate()<c)return a.toDate();if(b-a.toDate()>d)return c=new Date(a.toDate().getTime()+1E3*d),a.close(c),
newDate(c.getTime()+1E3);a.close(b);return!0},send:function(a){var b=k.defer(),c={},e=d.all();e.forEach(function(b){b.isOpen()&&b.close(a)});e.forEach(function(a){c[a.Id]=a.post()});k.all(c).then(function(a){return b.resolve(a)})["catch"](function(a){return b.reject(a)});return b.promise}}}])})(window.angular);(function(b,k){b.module("app.levantamentos").factory("RecursosModel",["dataservice","safellyRemoveFilter",function(b,f){function e(b){this.AtividadeTarefaId=b.AtividadeTarefaId;this.EmpresaId=b.EmpresaId;this.ObraId=b.ObraId;this.UserId=b.UserId;this.Atividade=b.Atividade;this.TarefaId=b.TarefaId;this.ContratadaId=b.ContratadaId;this.FuncaoId=b.FuncaoId;this.Inicio=b.Inicio;this.DataCriacao=b.DataCriacao;this.Colaboradores=b.Colaboradores;this.QuantidadeColaboradores=b.QuantidadeColaboradores;this.Comentarios=
b.Comentarios;this.status=b.status;this.Fim=b.Fim||null;this.DataAtualizacao=b.Fim||null;this.Id=b.Id||this.Inicio+this.FuncaoId+this.Colaboradores;this.queue();return this}var c={};Object.defineProperties(e.prototype,{identify:{value:function(){return this.Inicio+this.FuncaoId+this.Comentarios.toString()},enumerable:!1},close:{value:function(b){b=b.toISOString();this.unqueue();var e=this.Inicio+b+this.FuncaoId+this.comentariosId();c[e]?(c[e].QuantidadeColaboradores+=1,c[e].Colaboradores=c[e].Colaboradores+
", "+this.Colaboradores):(this.Id=e,this.Comentarios=this.comentariosToString(),this.DataAtualizacao=this.Fim=b,this.status="closed",this.queue());return c[e]},enumerable:!1},queue:{value:function(){c[this.Id]=this;return this},enumerable:!1},unqueue:{value:function(){delete c[this.Id];return this},enumerable:!1},toDate:{value:function(b){return b?new Date(this[b]):new Date(this.Inicio)},enumerable:!1},isOpen:{value:function(){return"open"===this.status?!0:!1},enumerable:!1},post:{value:function(){var c=
this;return b.post("levantamento",{AtividadeTarefaId:this.AtividadeTarefaId,EmpresaId:this.ContratadaId,ObraId:this.ObraId,UserId:this.UserId,TarefaId:this.TarefaId,FuncaoId:this.FuncaoId,Inicio:this.Inicio,DataCriacao:this.DataCriacao,Colaboradores:this.Colaboradores,QuantidadeColaboradores:this.QuantidadeColaboradores,Comentario:this.Comentarios,Fim:this.Fim,DataAtualizacao:this.DataAtualizacao}).then(function(b){200===b.status&&c.unqueue();500===b.status&&b.data.InnerException&&b.data.InnerException.InnerException&&
b.data.InnerException.InnerException.ExceptionMessage&&0===b.data.InnerException.InnerException.ExceptionMessage.indexof("Cannot insert duplicate key row in object")&&c.unqueue();return b},function(b){return b})},enumerable:!1},addComentario:{value:function(b){this.Comentarios.push(b);return this},enumerable:!1},removeComentario:{value:function(b){f(this.Comentarios,b);return this},enumerable:!1},comentariosId:{value:function(){return this.Comentarios.map(function(b){return b.Id}).toString()},enumerable:!1},
comentariosToString:{value:function(){return this.Comentarios.map(function(b){return b.value}).join(" | ")},enumerable:!1}});return{"new":function(b){return new e(b)},all:function(){return Object.keys(c).map(function(b){return c[b]})},reset:function(){c=[]}}}])})(window.angular);